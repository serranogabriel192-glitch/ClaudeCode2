<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sign In â€” Flyer Defense</title>
  <link rel="stylesheet" href="/css/style.css">
  <style>
    .camera-section {
      text-align: center;
      margin-bottom: 1.5rem;
    }
    .camera-preview {
      width: 240px;
      height: 180px;
      border-radius: var(--radius);
      background: #1a1a1a;
      margin: 0 auto .75rem;
      overflow: hidden;
      position: relative;
    }
    .camera-preview video,
    .camera-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .camera-preview canvas { display: none; }
    .camera-btns {
      display: flex;
      gap: .5rem;
      justify-content: center;
    }
    .escort-flag {
      display: inline-block;
      background: #c62828;
      color: #fff;
      padding: .15rem .5rem;
      border-radius: 4px;
      font-size: .75rem;
      font-weight: 700;
      margin-left: .5rem;
    }
  </style>
</head>
<body>
  <div class="topbar">
    <div class="logo"><img src="/img/logo.svg" alt="Flyer Defense" style="color:#fff;filter:brightness(0) invert(1);"></div>
    <div>
      <a href="/">Home</a>
      <a href="/signout.html">Sign Out</a>
      <a href="/admin.html">Admin</a>
    </div>
  </div>

  <div class="page">
    <div id="alert"></div>

    <div class="card">
      <h2>Visitor Sign-In</h2>

      <div class="camera-section">
        <div class="camera-preview" id="cameraBox">
          <video id="video" autoplay playsinline muted></video>
          <canvas id="canvas"></canvas>
          <img id="snapshot" style="display:none;">
        </div>
        <div class="camera-btns">
          <button type="button" class="btn btn-primary btn-sm" id="captureBtn" onclick="capturePhoto()">Take Photo</button>
          <button type="button" class="btn btn-outline-dark btn-sm" id="retakeBtn" onclick="retakePhoto()" style="display:none;">Retake</button>
        </div>
      </div>

      <form id="signinForm">
        <div class="form-row">
          <div class="form-group">
            <label class="required" for="visitor_name">Full Name</label>
            <input type="text" id="visitor_name" name="visitor_name" required autocomplete="off">
          </div>
          <div class="form-group">
            <label for="company">Company</label>
            <input type="text" id="company" name="company" autocomplete="off">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="email">Email</label>
            <input type="email" id="email" name="email" autocomplete="off">
          </div>
          <div class="form-group">
            <label for="phone">Phone</label>
            <input type="tel" id="phone" name="phone" autocomplete="off">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="required" for="host_name">Host (Person You're Visiting)</label>
            <input type="text" id="host_name" name="host_name" required autocomplete="off">
          </div>
          <div class="form-group">
            <label for="host_email">Host Email</label>
            <input type="email" id="host_email" name="host_email" autocomplete="off" placeholder="For arrival notification">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="required" for="purpose">Purpose of Visit</label>
            <select id="purpose" name="purpose" required>
              <option value="Meeting">Meeting</option>
              <option value="Interview">Interview</option>
              <option value="Delivery">Delivery</option>
              <option value="Maintenance">Maintenance</option>
              <option value="Contractor">Contractor</option>
              <option value="Tour">Tour</option>
              <option value="Other">Other</option>
            </select>
          </div>
          <div class="form-group">
            <label class="required" for="nationality">Nationality</label>
            <input type="text" id="nationality" name="nationality" required autocomplete="off" placeholder="e.g. US, UK, etc.">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="required" for="access_type">Access Type</label>
            <select id="access_type" name="access_type" required onchange="updateEscort()">
              <option value="Unescorted">Unescorted</option>
              <option value="Escorted">Escorted (Escort Required)</option>
              <option value="Restricted">Restricted Area</option>
              <option value="Contractor">Contractor Access</option>
            </select>
          </div>
          <div class="form-group">
            <label for="escort_required">
              <input type="checkbox" id="escort_required" name="escort_required" style="width:auto;margin-right:.35rem;">
              Escort Required
            </label>
          </div>
        </div>

        <div class="form-group">
          <label for="notes">Notes</label>
          <textarea id="notes" name="notes" rows="2" placeholder="Any additional information"></textarea>
        </div>

        <button type="submit" class="btn btn-success btn-lg" style="width:100%;">Sign In</button>
      </form>
    </div>
  </div>

  <script src="/js/signin.js"></script>
</body>
</html>
